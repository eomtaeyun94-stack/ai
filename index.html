<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI ë°ëª¨ â€” ë­ê°€ ê¶ê¸ˆí•˜ì„¸ìš”?</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#60a5fa;--muted:#94a3b8;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR','Apple SD Gothic Neo','Malgun Gothic',sans-serif;background:linear-gradient(135deg,#071026 0%, #081124 60%);color:#e6eef8;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .wrap{width:100%;max-width:920px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
    h1{font-size:1.25rem;margin:0}
    .muted{color:var(--muted);font-size:0.9rem}
    .chat{height:420px;overflow:auto;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.02)}
    .msg{max-width:78%;padding:10px 12px;border-radius:10px;margin-bottom:10px;word-break:break-word}
    .user{background:linear-gradient(90deg,#0b1220,#071026);margin-left:auto;border:1px solid rgba(255,255,255,0.03)}
    .ai{background:linear-gradient(90deg,#0b1f33,#06202b);border:1px solid rgba(96,165,250,0.15)}
    .controls{display:flex;gap:8px;margin-top:12px}
    input[type=text]{flex:1;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    button{padding:10px 14px;border-radius:10px;border:0;background:var(--accent);color:#02203a;cursor:pointer;font-weight:600}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);font-weight:600}
    .small{font-size:0.85rem;padding:8px 10px;border-radius:8px}
    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center}
    .modal{width:100%;max-width:720px;background:var(--card);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03)}
    .field{margin-bottom:10px}
    label{display:block;font-size:0.9rem;margin-bottom:6px;color:var(--muted)}
    textarea,select{width:100%;padding:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:inherit;min-height:80px}
    .row{display:flex;gap:8px}
    .tag{font-size:0.8rem;padding:6px 8px;border-radius:999px;background:var(--glass);border:1px dashed rgba(255,255,255,0.02);color:var(--muted)}
    .toast{position:fixed;right:20px;bottom:20px;background:#052033;padding:10px 14px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);display:none}
    footer{display:flex;align-items:center;justify-content:space-between;margin-top:10px;color:var(--muted);font-size:0.9rem}
    .credits{font-size:0.8rem;color:var(--muted)}
    @media (max-width:640px){.chat{height:60vh}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <div>
          <h1>AI ë°ëª¨</h1>
          <div class="muted">ê°„ë‹¨í•œ ì‹œì—°ê³¼ ì˜¤ë¥˜ ì‹ ê³  ê¸°ëŠ¥ í¬í•¨</div>
        </div>
        <div class="row">
          <div class="tag">ë­ê°€ ê¶ê¸ˆí•˜ì„¸ìš”?</div>
          <button class="small ghost" id="open-report">ì˜¤ë¥˜ ì‹ ê³ </button>
        </div>
      </header>

      <main>
        <div id="chat" class="chat" aria-live="polite"></div>

        <div class="controls">
          <input id="user-input" type="text" placeholder="ë­ê°€ ê¶ê¸ˆí•˜ì„¸ìš”?" aria-label="ì§ˆë¬¸ ì…ë ¥" />
          <button id="send">ì „ì†¡</button>
        </div>

        <footer>
          <div class="credits">ì˜¤í”„ë¼ì¸ ë°ëª¨ â€” ì„œë²„ê°€ í•„ìš” ì—†ì–´ìš”</div>
          <div class="muted">ì—ëŸ¬ ì‹ ê³  ì‹œ í˜„ì¬ ìƒíƒœë¥¼ íŒŒì¼ë¡œ ì €ì¥í•˜ê±°ë‚˜ ì´ë©”ì¼ë¡œ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
        </footer>
      </main>
    </div>
  </div>

  <!-- ëª¨ë‹¬: ì˜¤ë¥˜ ì‹ ê³  -->
  <div id="modal" class="modal-backdrop" role="dialog" aria-modal="true">
    <div class="modal">
      <h2>ì˜¤ë¥˜ ì‹ ê³ </h2>
      <p class="muted">ë°œìƒí•œ ë¬¸ì œë¥¼ ìì„¸íˆ ì ì–´ ì£¼ì„¸ìš”. (ì„ íƒ: ë¡œê·¸ì™€ ìƒíƒœ í¬í•¨)</p>

      <div class="field">
        <label for="issue-type">ë¬¸ì œ ìœ í˜•</label>
        <select id="issue-type">
          <option>UI ì˜¤ë¥˜</option>
          <option>ê¸°ëŠ¥ ë™ì‘ ë¶ˆê°€</option>
          <option>ì„±ëŠ¥ ëŠë¦¼</option>
          <option>ê¸°íƒ€</option>
        </select>
      </div>

      <div class="field">
        <label for="issue-desc">ìƒì„¸ ì„¤ëª…</label>
        <textarea id="issue-desc" placeholder="ì–´ë–¤ ìƒí™©ì—ì„œ ì–´ë–¤ ë™ì‘ì„ í–ˆë‚˜ìš”? ê°€ëŠ¥í•œ ì¬í˜„ ìˆœì„œë¥¼ ì ì–´ ì£¼ì„¸ìš”."></textarea>
      </div>

      <div class="field row">
        <label style="flex:1"><input id="include-logs" type="checkbox" /> ì½˜ì†” ë¡œê·¸ í¬í•¨</label>
        <label style="flex:1"><input id="include-state" type="checkbox" /> ë¡œì»¬ ìƒíƒœ í¬í•¨</label>
      </div>

      <div class="field row" style="justify-content:flex-end">
        <button class="ghost small" id="cancel-report">ì·¨ì†Œ</button>
        <button id="send-report" class="small">ì‹ ê³  ìƒì„±</button>
      </div>

      <div style="margin-top:8px;font-size:0.85rem;color:var(--muted)">ìƒì„±ëœ ì‹ ê³ ëŠ” íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œë˜ë©°, ì´ë©”ì¼ë¡œ ì „ì†¡í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    // ===== ì½˜ì†” ìº¡ì²˜ (ê°„ë‹¨) =====
    (function(){
      const origLog = console.log;
      window.__capturedLogs = [];
      console.log = function(...args){
        try{ window.__capturedLogs.push({ts: new Date().toISOString(), args: args.map(a=> (typeof a === 'object' ? JSON.stringify(a) : String(a)).slice(0,200))}); }catch(e){}
        origLog.apply(console, args);
      };
      console.debug = console.log; console.info = console.log; console.error = console.log;
    })();

    // ===== ìœ í‹¸ =====
    const $ = sel => document.querySelector(sel);
    const chatEl = $('#chat');
    const input = $('#user-input');
    const toast = $('#toast');

    function addMsg(text, who='ai'){
      const div = document.createElement('div');
      div.className = 'msg ' + (who === 'user' ? 'user' : 'ai');
      div.textContent = text;
      chatEl.appendChild(div);
      chatEl.scrollTop = chatEl.scrollHeight;
      // store in local state
      const history = JSON.parse(localStorage.getItem('demo_chat_history')||'[]');
      history.push({who, text, ts:new Date().toISOString()});
      localStorage.setItem('demo_chat_history', JSON.stringify(history));
    }

    // ì´ˆê¸° ë©”ì‹œì§€
    function seed(){
      const history = JSON.parse(localStorage.getItem('demo_chat_history')||'[]');
      if(history.length===0){
        addMsg('ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì´ ê¶ê¸ˆí•˜ì„¸ìš”? ğŸ˜Š', 'ai');
      } else {
        history.forEach(m=> addMsg(m.text, m.who));
      }
    }

    // ê°„ë‹¨í•œ AI ì‹œë®¬ë ˆì´ì…˜ (ì„œë²„ ì—†ìŒ)
    function simulateAI(userText){
      addMsg(userText,'user');
      // fake thinking
      setTimeout(()=>{
        // ê°„ë‹¨ ì²˜ë¦¬: ì§ˆë¬¸ì— echoê±°ë‚˜ ê¸°ë³¸ ì‘ë‹µ
        let response = '';
        if(/ì•ˆë…•|ì•ˆë…•í•˜ì„¸ìš”|ã…ã…‡/.test(userText)) response = 'ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?';
        else if(/ì˜¤ë¥˜|ì—ëŸ¬|ë²„ê·¸/.test(userText)) response = 'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‚˜ìš”? ì˜¤ë¥˜ ì‹ ê³  ë²„íŠ¼ì„ ëˆŒëŸ¬ ì œë³´í•´ ì£¼ì„¸ìš”.';
        else if(userText.trim().length<3) response = 'ì¡°ê¸ˆ ë” ìì„¸íˆ ì ì–´ ì£¼ì‹¤ë˜ìš”?';
        else response = 'ì¢‹ì€ ì§ˆë¬¸ì´ì—ìš”! ì§€ê¸ˆì€ ì˜¤í”„ë¼ì¸ ë°ëª¨ë¼ ê°„ë‹¨íˆ ë³µì°½í•´ ë“œë ¤ìš”: "' + userText + '"';
        addMsg(response,'ai');
        console.log('simulated-response', {q:userText, a:response});
      }, 700 + Math.random()*600);
    }

    // ì´ë²¤íŠ¸
    $('#send').addEventListener('click', ()=>{
      const v = input.value.trim();
      if(!v) return showToast('ì§ˆë¬¸ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”');
      simulateAI(v);
      input.value = '';
      input.focus();
    });

    input.addEventListener('keydown', (e)=>{ if(e.key==='Enter') { e.preventDefault(); $('#send').click(); } });

    // í† ìŠ¤íŠ¸
    let toastTimer = null;
    function showToast(txt, ms=2500){
      toast.textContent = txt; toast.style.display='block';
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=> toast.style.display='none', ms);
    }

    // ëª¨ë‹¬ ì œì–´
    $('#open-report').addEventListener('click', ()=>{ $('#modal').style.display='flex'; });
    $('#cancel-report').addEventListener('click', ()=>{ $('#modal').style.display='none'; });

    // ì˜¤ë¥˜ ì‹ ê³  ìƒì„±
    $('#send-report').addEventListener('click', ()=>{
      const type = $('#issue-type').value;
      const desc = $('#issue-desc').value.trim();
      const withLogs = $('#include-logs').checked;
      const withState = $('#include-state').checked;

      const report = {
        id: 'report-' + Date.now(),
        ts: new Date().toISOString(),
        userAgent: navigator.userAgent,
        url: location.href,
        type,
        description: desc,
        lastInput: input.value || null,
        chatHistory: JSON.parse(localStorage.getItem('demo_chat_history')||'[]')
      };

      if(withLogs) report.consoleLogs = window.__capturedLogs || [];
      if(withState) report.localStorage = (function(){try{return JSON.parse(JSON.stringify(localStorage));}catch(e){return String(localStorage);} })();

      // make file
      const blob = new Blob([JSON.stringify(report, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = report.id + '.json';
      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);

      // offer mailto (limited length) and copy to clipboard
      const mailSubject = encodeURIComponent('[ì˜¤ë¥˜ì‹ ê³ ] ' + type + ' â€” ' + report.id);
      const mailBodyShort = encodeURIComponent('ê°„ë‹¨ ì„¤ëª…:\n' + desc + '\n\në³´ê³ ì„œ íŒŒì¼ì„ ì²¨ë¶€í–ˆìŠµë‹ˆë‹¤.');
      // open mail client in new window (user can attach file manually)
      window.open('mailto:support@example.com?subject=' + mailSubject + '&body=' + mailBodyShort);

      showToast('ì‹ ê³  íŒŒì¼ì´ ìƒì„±ë˜ì–´ ë‹¤ìš´ë¡œë“œ ë˜ì—ˆìŠµë‹ˆë‹¤. ë©”ì¼ í´ë¼ì´ì–¸íŠ¸ë„ ì—´ì—ˆìŠµë‹ˆë‹¤.');
      $('#modal').style.display='none';
    });

    // ì´ˆê¸°í™”
    seed();

    // ê°œë°œì ìœ í‹¸: í˜ì´ì§€ ìƒíƒœ ì´ˆê¸°í™” (long-press ì˜¤ë¥¸ìª½ í•˜ë‹¨ í† ìŠ¤íŠ¸ í´ë¦­?)
    // (ì´ ì½”ë“œëŠ” ë°ëª¨ë¥¼ ìœ„í•´ ë‚¨ê²¨ë‘¡ë‹ˆë‹¤)
    console.log('demo-ready');
  </script>
</body>
</html>
