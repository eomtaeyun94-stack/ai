<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI ë°ëª¨ â€” ë­ê°€ ê¶ê¸ˆí•˜ì„¸ìš”?</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#60a5fa;--muted:#94a3b8;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR','Apple SD Gothic Neo','Malgun Gothic',sans-serif;background:linear-gradient(135deg,#071026 0%, #081124 60%);color:#e6eef8;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .wrap{width:100%;max-width:1100px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
    h1{font-size:1.25rem;margin:0}
    .muted{color:var(--muted);font-size:0.9rem}
    .layout{display:grid;grid-template-columns:1fr 360px;gap:14px}
    .chat{height:520px;overflow:auto;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.02)}
    .msg{max-width:78%;padding:10px 12px;border-radius:10px;margin-bottom:10px;word-break:break-word}
    .user{background:linear-gradient(90deg,#0b1220,#071026);margin-left:auto;border:1px solid rgba(255,255,255,0.03)}
    .ai{background:linear-gradient(90deg,#0b1f33,#06202b);border:1px solid rgba(96,165,250,0.15)}
    .controls{display:flex;gap:8px;margin-top:12px}
    input[type=text]{flex:1;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    button{padding:10px 14px;border-radius:10px;border:0;background:var(--accent);color:#02203a;cursor:pointer;font-weight:600}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);font-weight:600}
    .small{font-size:0.85rem;padding:8px 10px;border-radius:8px}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border-radius:10px;padding:12px;border:1px solid rgba(255,255,255,0.02);height:520px;overflow:auto}
    .report-item{padding:10px;border-radius:8px;margin-bottom:8px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02);cursor:pointer}
    .report-item:hover{transform:translateY(-2px)}
    .meta{font-size:0.85rem;color:var(--muted)}
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center}
    .modal{width:100%;max-width:880px;background:var(--card);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03)}
    .field{margin-bottom:10px}
    label{display:block;font-size:0.9rem;margin-bottom:6px;color:var(--muted)}
    textarea,select{width:100%;padding:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:inherit;min-height:80px}
    .row{display:flex;gap:8px}
    .tag{font-size:0.8rem;padding:6px 8px;border-radius:999px;background:var(--glass);border:1px dashed rgba(255,255,255,0.02);color:var(--muted)}
    .toast{position:fixed;right:20px;bottom:20px;background:#052033;padding:10px 14px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);display:none}
    footer{display:flex;align-items:center;justify-content:space-between;margin-top:10px;color:var(--muted);font-size:0.9rem}
    .empty{color:var(--muted);font-size:0.95rem;text-align:center;margin-top:36px}
    pre{background:rgba(0,0,0,0.25);padding:10px;border-radius:8px;overflow:auto}
    @media (max-width:1000px){.layout{grid-template-columns:1fr} .panel{height:auto;}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <div>
          <h1>AI ë°ëª¨</h1>
          <div class="muted">ê°„ë‹¨ ì‹œì—° + ë‚´ì¥ëœ ì‹ ê³  ì„¼í„°</div>
        </div>
        <div class="row">
          <div class="tag">ë­ê°€ ê¶ê¸ˆí•˜ì„¸ìš”?</div>
          <button class="small ghost" id="open-report">ì˜¤ë¥˜ ì‹ ê³ </button>
          <button class="small" id="open-center">ì‹ ê³  ì„¼í„°</button>
        </div>
      </header>

      <main class="layout">
        <section>
          <div id="chat" class="chat" aria-live="polite"></div>

          <div class="controls">
            <input id="user-input" type="text" placeholder="ë­ê°€ ê¶ê¸ˆí•˜ì„¸ìš”?" aria-label="ì§ˆë¬¸ ì…ë ¥" />
            <button id="send">ì „ì†¡</button>
          </div>

          <footer>
            <div class="credits">ì˜¤í”„ë¼ì¸ ë°ëª¨ â€” ì„œë²„ ì—†ì´ ë™ì‘</div>
            <div class="muted">ì‹ ê³ ëŠ” ë¸Œë¼ìš°ì €ì˜ ë¡œì»¬ ì €ì¥ì†Œì— ì•ˆì „í•˜ê²Œ ë³´ê´€ë©ë‹ˆë‹¤</div>
          </footer>
        </section>

        <aside>
          <div class="panel" id="side-panel">
            <h3 style="margin-top:0">ìµœê·¼ í™œë™</h3>
            <div id="recent-list" class="muted">ì•„ì§ ëŒ€í™”ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
          </div>
        </aside>
      </main>
    </div>
  </div>

  <!-- ì‹ ê³  ëª¨ë‹¬ -->
  <div id="modal" class="modal-backdrop" role="dialog" aria-modal="true">
    <div class="modal">
      <h2>ì˜¤ë¥˜ ì‹ ê³ </h2>
      <p class="muted">ë°œìƒí•œ ë¬¸ì œë¥¼ ìì„¸íˆ ì ì–´ ì£¼ì„¸ìš”. (ì„ íƒ: ë¡œê·¸ì™€ ìƒíƒœ í¬í•¨)</p>

      <div class="field">
        <label for="issue-type">ë¬¸ì œ ìœ í˜•</label>
        <select id="issue-type">
          <option>UI ì˜¤ë¥˜</option>
          <option>ê¸°ëŠ¥ ë™ì‘ ë¶ˆê°€</option>
          <option>ì„±ëŠ¥ ëŠë¦¼</option>
          <option>ê¸°íƒ€</option>
        </select>
      </div>

      <div class="field">
        <label for="issue-desc">ìƒì„¸ ì„¤ëª…</label>
        <textarea id="issue-desc" placeholder="ì–´ë–¤ ìƒí™©ì—ì„œ ì–´ë–¤ ë™ì‘ì„ í–ˆë‚˜ìš”? ê°€ëŠ¥í•œ ì¬í˜„ ìˆœì„œë¥¼ ì ì–´ ì£¼ì„¸ìš”."></textarea>
      </div>

      <div class="field row">
        <label style="flex:1"><input id="include-logs" type="checkbox" /> ì½˜ì†” ë¡œê·¸ í¬í•¨</label>
        <label style="flex:1"><input id="include-state" type="checkbox" /> ë¡œì»¬ ìƒíƒœ í¬í•¨</label>
      </div>

      <div class="field row" style="justify-content:flex-end">
        <button class="ghost small" id="cancel-report">ì·¨ì†Œ</button>
        <button id="send-report" class="small">ì‹ ê³  ìƒì„±</button>
      </div>

      <div style="margin-top:8px;font-size:0.85rem;color:var(--muted)">ì‹ ê³ ëŠ” ì´ ë¸Œë¼ìš°ì €ì— ì €ì¥ë˜ë©° ì‹ ê³  ì„¼í„°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
    </div>
  </div>

  <!-- ì‹ ê³  ì„¼í„° ëª¨ë‹¬ -->
  <div id="center-modal" class="modal-backdrop" role="dialog" aria-modal="true">
    <div class="modal">
      <h2>ì‹ ê³  ì„¼í„°</h2>
      <p class="muted">ì—¬ê¸°ì— ì œì¶œí•œ ëª¨ë“  ì‹ ê³  ëª©ë¡ì´ í‘œì‹œë©ë‹ˆë‹¤. (ë¡œì»¬ ì €ì¥ì†Œ)</p>

      <div style="display:flex;gap:8px;margin-bottom:10px">
        <input id="filter-type" placeholder="í•„í„°: ìœ í˜• ê²€ìƒ‰" style="flex:1;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)" />
        <button id="clear-all" class="ghost small">ëª¨ë‘ ì‚­ì œ</button>
      </div>

      <div id="report-list" style="max-height:420px;overflow:auto"></div>

      <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px">
        <button class="ghost small" id="close-center">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    // ===== ì½˜ì†” ìº¡ì²˜ (ê°„ë‹¨) =====
    (function(){
      const origLog = console.log;
      window.__capturedLogs = [];
      console.log = function(...args){
        try{ window.__capturedLogs.push({ts: new Date().toISOString(), args: args.map(a=> (typeof a === 'object' ? JSON.stringify(a) : String(a)).slice(0,200))}); }catch(e){}
        origLog.apply(console, args);
      };
      console.debug = console.log; console.info = console.log; console.error = console.log;
    })();

    // ===== ìœ í‹¸ =====
    const $ = sel => document.querySelector(sel);
    const chatEl = $('#chat');
    const input = $('#user-input');
    const toast = $('#toast');
    const REPORT_KEY = 'demo_reports_v1';

    function saveReports(list){ localStorage.setItem(REPORT_KEY, JSON.stringify(list)); }
    function loadReports(){ try{ return JSON.parse(localStorage.getItem(REPORT_KEY)||'[]'); }catch(e){ return []; } }

    function addMsg(text, who='ai'){
      const div = document.createElement('div');
      div.className = 'msg ' + (who === 'user' ? 'user' : 'ai');
      div.textContent = text;
      chatEl.appendChild(div);
      chatEl.scrollTop = chatEl.scrollHeight;
      // store in local state
      const history = JSON.parse(localStorage.getItem('demo_chat_history')||'[]');
      history.push({who, text, ts:new Date().toISOString()});
      localStorage.setItem('demo_chat_history', JSON.stringify(history));
      renderRecent();
    }

    // ì´ˆê¸° ë©”ì‹œì§€
    function seed(){
      const history = JSON.parse(localStorage.getItem('demo_chat_history')||'[]');
      if(history.length===0){
        addMsg('ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì´ ê¶ê¸ˆí•˜ì„¸ìš”? ğŸ˜Š', 'ai');
      } else {
        history.forEach(m=> addMsg(m.text, m.who));
      }
    }

    // ê°„ë‹¨í•œ AI ì‹œë®¬ë ˆì´ì…˜ (ì„œë²„ ì—†ìŒ)
    function simulateAI(userText){
      addMsg(userText,'user');
      // fake thinking
      setTimeout(()=>{
        let response = '';
        if(/ì•ˆë…•|ì•ˆë…•í•˜ì„¸ìš”|ã…ã…‡/.test(userText)) response = 'ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?';
        else if(/ì˜¤ë¥˜|ì—ëŸ¬|ë²„ê·¸/.test(userText)) response = 'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‚˜ìš”? ì˜¤ë¥˜ ì‹ ê³  ë²„íŠ¼ìœ¼ë¡œ ì œë³´í•´ ì£¼ì„¸ìš”.';
        else if(userText.trim().length<3) response = 'ì¡°ê¸ˆ ë” ìì„¸íˆ ì ì–´ ì£¼ì‹¤ë˜ìš”?';
        else response = 'ì¢‹ì€ ì§ˆë¬¸ì´ì—ìš”! ì§€ê¸ˆì€ ì˜¤í”„ë¼ì¸ ë°ëª¨ë¼ ê°„ë‹¨íˆ ë³µì°½í•´ ë“œë ¤ìš”: "' + userText + '"';
        addMsg(response,'ai');
        console.log('simulated-response', {q:userText, a:response});
      }, 700 + Math.random()*600);
    }

    // ì´ë²¤íŠ¸
    $('#send').addEventListener('click', ()=>{
      const v = input.value.trim();
      if(!v) return showToast('ì§ˆë¬¸ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”');
      simulateAI(v);
      input.value = '';
      input.focus();
    });

    input.addEventListener('keydown', (e)=>{ if(e.key==='Enter') { e.preventDefault(); $('#send').click(); } });

    // í† ìŠ¤íŠ¸
    let toastTimer = null;
    function showToast(txt, ms=2500){
      toast.textContent = txt; toast.style.display='block';
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=> toast.style.display='none', ms);
    }

    // ëª¨ë‹¬ ì œì–´
    $('#open-report').addEventListener('click', ()=>{ $('#modal').style.display='flex'; $('#issue-desc').focus(); });
    $('#cancel-report').addEventListener('click', ()=>{ $('#modal').style.display='none'; });
    $('#open-center').addEventListener('click', ()=>{ renderReportList(); $('#center-modal').style.display='flex'; });
    $('#close-center').addEventListener('click', ()=>{ $('#center-modal').style.display='none'; });

    // ì‹ ê³  ìƒì„± -> localStorageì— ì €ì¥
    $('#send-report').addEventListener('click', ()=>{
      const type = $('#issue-type').value;
      const desc = $('#issue-desc').value.trim();
      const withLogs = $('#include-logs').checked;
      const withState = $('#include-state').checked;

      if(!desc){ showToast('ìƒì„¸ ì„¤ëª…ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”'); return; }

      const report = {
        id: 'report-' + Date.now(),
        ts: new Date().toISOString(),
        userAgent: navigator.userAgent,
        url: location.href,
        type,
        description: desc,
        chatHistory: JSON.parse(localStorage.getItem('demo_chat_history')||'[]')
      };

      if(withLogs) report.consoleLogs = window.__capturedLogs || [];
      if(withState) report.localStorage = (function(){try{return JSON.parse(JSON.stringify(localStorage));}catch(e){return String(localStorage);} })();

      const list = loadReports();
      list.unshift(report); // ìµœì‹ ìˆœ
      saveReports(list);

      showToast('ì‹ ê³ ê°€ ì‹ ê³  ì„¼í„°ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
      $('#modal').style.display='none';
      $('#issue-desc').value = '';
    });

    // ì‹ ê³  ì„¼í„° ë Œë”
    function renderReportList(filterText=''){
      const container = $('#report-list');
      const list = loadReports();
      container.innerHTML = '';
      if(list.length===0){ container.innerHTML = '<div class="empty">ì‹ ê³ ê°€ ì•„ì§ ì—†ìŠµë‹ˆë‹¤.</div>'; return; }

      const filtered = list.filter(r => r.type.includes(filterText) || r.description.includes(filterText));
      if(filtered.length===0){ container.innerHTML = '<div class="empty">í•„í„° ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>'; return; }

      filtered.forEach(r => {
        const el = document.createElement('div');
        el.className = 'report-item';
        el.innerHTML = `<strong>${r.type}</strong> <div class="meta">${new Date(r.ts).toLocaleString()} Â· ${r.id}</div><div class="muted" style="margin-top:6px">${(r.description||'').slice(0,120)}${(r.description && r.description.length>120? '...':'')}</div>`;
        el.addEventListener('click', ()=> showReportDetail(r.id));
        container.appendChild(el);
      });
    }

    // ìƒì„¸ ë³´ê¸°
    function showReportDetail(id){
      const reports = loadReports();
      const r = reports.find(x=>x.id===id);
      if(!r) { showToast('ì‹ ê³ ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤'); return; }

      // ìƒì„¸ ë‚´ìš©ì„ ëª¨ë‹¬ë¡œ í‘œì‹œ (ì¬ì‚¬ìš© ëª¨ë‹¬ ì°½)
      const detailHtml = document.createElement('div');
      detailHtml.innerHTML = `
        <h3 style="margin-top:0">${r.type} Â· ${new Date(r.ts).toLocaleString()}</h3>
        <div class="meta">ID: ${r.id}</div>
        <p style="white-space:pre-wrap;margin-top:8px">${r.description}</p>
        <div style="margin-top:8px"><strong>í™˜ê²½</strong><div class="meta">${r.userAgent}</div></div>
        <div style="margin-top:8px"><strong>ì±„íŒ… ìµœê·¼ í•­ëª©</strong><pre>${(r.chatHistory||[]).slice(-6).map(h=> h.who+': '+h.text).join('
') || 'ì—†ìŒ'}</pre></div>
      `;

      // ì¶”ê°€ ë²„íŠ¼: ë‚´ë³´ë‚´ê¸°, ì‚­ì œ, ë‹«ê¸°
      const btnRow = document.createElement('div');
      btnRow.style.display='flex'; btnRow.style.gap='8px'; btnRow.style.justifyContent='flex-end'; btnRow.style.marginTop='12px';

      const exportBtn = document.createElement('button'); exportBtn.className='small'; exportBtn.textContent='ë‚´ë³´ë‚´ê¸°';
      const deleteBtn = document.createElement('button'); deleteBtn.className='ghost small'; deleteBtn.textContent='ì‚­ì œ';
      const closeBtn = document.createElement('button'); closeBtn.className='ghost small'; closeBtn.textContent='ë‹«ê¸°';

      btnRow.appendChild(deleteBtn); btnRow.appendChild(exportBtn); btnRow.appendChild(closeBtn);
      detailHtml.appendChild(btnRow);

      // ì„ì‹œ ìƒì„¸ ëª¨ë‹¬
      const backdrop = document.createElement('div');
      backdrop.style.position='fixed'; backdrop.style.inset='0'; backdrop.style.background='rgba(2,6,23,0.6)'; backdrop.style.display='flex'; backdrop.style.alignItems='center'; backdrop.style.justifyContent='center';
      const box = document.createElement('div'); box.style.background='var(--card)'; box.style.padding='18px'; box.style.borderRadius='12px'; box.style.maxWidth='820px'; box.style.width='90%'; box.style.maxHeight='80%'; box.style.overflow='auto';
      box.appendChild(detailHtml);
      backdrop.appendChild(box);
      document.body.appendChild(backdrop);

      closeBtn.addEventListener('click', ()=> { backdrop.remove(); });
      deleteBtn.addEventListener('click', ()=>{
        if(!confirm('ì •ë§ ì´ ì‹ ê³ ë¥¼ ì‚­ì œí•˜ì‹œê² ì–´ìš”?')) return;
        const remaining = loadReports().filter(x=>x.id!==id);
        saveReports(remaining);
        showToast('ì‹ ê³ ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        backdrop.remove();
        renderReportList($('#filter-type').value.trim());
      });

      exportBtn.addEventListener('click', ()=>{
        const blob = new Blob([JSON.stringify(r, null, 2)], {type:'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = r.id + '.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
        showToast('ì‹ ê³ ë¥¼ JSONìœ¼ë¡œ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤.');
      });
    }

    // í•„í„°
    $('#filter-type').addEventListener('input', (e)=>{ renderReportList(e.target.value.trim()); });

    // ëª¨ë‘ ì‚­ì œ
    $('#clear-all').addEventListener('click', ()=>{
      if(!confirm('ì‹ ê³  ëª©ë¡ì„ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ì–´ìš”?')) return;
      saveReports([]);
      renderReportList();
      showToast('ëª¨ë‘ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
    });

    // ì‚¬ì´ë“œ ìµœê·¼ í™œë™ ë Œë”
    function renderRecent(){
      const el = $('#recent-list');
      const h = JSON.parse(localStorage.getItem('demo_chat_history')||'[]');
      if(!h || h.length===0){ el.textContent = 'ì•„ì§ ëŒ€í™”ê°€ ì—†ìŠµë‹ˆë‹¤.'; return; }
      const last = h.slice(-6).reverse();
      el.innerHTML = last.map(x=> `<div style="margin-bottom:8px"><strong>${x.who==='user'?'You':'AI'}</strong> <div class="meta">${new Date(x.ts).toLocaleTimeString()}</div><div class="muted">${x.text.slice(0,80)}</div></div>`).join('');
    }

    // ì´ˆê¸°í™”
    seed(); renderRecent();
    console.log('demo-ready');
  </script>
</body>
</html>
